{% extends 'base.html' %}
{% block head %}
	<title>Search Results - USGS Publications Warehouse</title>
	<meta name="description" content="Search results for USGS Publications Warehouse">
    {% include 'meta.html' %}
{% endblock head %}

{% block page_style %}
	<link rel="stylesheet" href="{{ url_for('static', filename = 'css/pagination.css') }}">
{% endblock page_style %}

{% block main %}

    {% if pagination %}
		<section id="results" class="search-results">
                {{ pagination.info|safe }}
		</section>
        <h1 class="search-results">Search Results</h1>
        <form class="search-results" style="display: inline;" action="{{ url_for('api_webargs') }}" method="get" name="q">
            {{ form.q(placeholder="search terms") }}
        </form>
        <section id="search-results">
				{% for result in search_result_records %}
					<article>
                        <h4><a class="search-title" href="{{ url_for('publication', indexid = result['indexid']) }}">{{ result['title']|safe }}</a></h4>
                        <p class="pubinfo">{{ result|display_pub_info }}</p>
                        {% if result['authorslist']|length > 0 %}<p class="searchcontributors">{{ result['authorslist']|join(', ') }}</p>{% endif %}
                        {% if result['editorslist']|length > 0 %}<p class="searchcontributors">{{ result['editorslist']|join(', ') }}, editor(s)</p>{% endif %}
                        {% if result['docabstract']  %}<p>{{ result['docabstract'].split(' ')[0:50]|join(' ')|striptags }}...</p>{% endif %}
					</article>
				{% endfor %}
        </section>
		<div>
            <section class="pagination-nav">
                {{ pagination.links|safe }}
            </section>
		</div>
	{% else %}
		{{ search_service_down }}
	{% endif %}
{% endblock main %}